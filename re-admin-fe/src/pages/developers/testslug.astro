<!-- ---
const API_BASE = "https://brick-com-admin.onrender.com";

type Developer = {
  slug: string;
  // add other expected fields if needed
};

export async function getStaticPaths() {
  try {
    const res = await fetch(`${API_BASE}/api/public/developers?limit=1000`);
    if (!res.ok) throw new Error(`API error status: ${res.status}`);

    const json = await res.json();
    const developers = json.data?.rows || [];

    const paths = developers
      .filter((dev: Developer) => dev.slug && typeof dev.slug === "string")
      .map((dev: Developer) => ({ params: { slug: dev.slug } }));

    if (paths.length === 0) {
      console.warn("No valid developer slugs found, using fallback slug.");
      return {
        paths: [{ params: { slug: "fallback-slug" } }],
        fallback: false,
      };
    }

    return { paths, fallback: false };
  } catch (e) {
    console.error("Error in getStaticPaths:", e);
    return { paths: [{ params: { slug: "fallback-slug" } }], fallback: false };
  }
}

const { slug } = Astro.params;

let developer = null;
try {
  const res = await fetch(`${API_BASE}/api/public/developers/${slug}`);
  if (res.ok) {
    const json = await res.json();
    developer = json.data;
    if (!developer) {
      console.warn(`Developer data not found for slug: ${slug}`);
    }
  } else {
    console.warn(
      `Failed fetching developer for slug: ${slug}, status: ${res.status}`
    );
  }
} catch (e) {
  console.error("Failed to load developer data:", e);
}
---

<html>
  <head>
    <title>{developer ? developer.name : "Developer Not Found"}</title>
  </head>
  <body>
    {
      developer ? (
        <>
          <h1>{developer.name}</h1>
          <p>{developer.description}</p>
          {/* Add more developer details here */}
        </>
      ) : (
        <p>Developer data not available.</p>
      )
    }
  </body>
</html> -->
